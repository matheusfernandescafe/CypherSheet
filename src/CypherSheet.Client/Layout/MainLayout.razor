@using CypherSheet.Client.Services
@inherits LayoutComponentBase
@inject IThemeService ThemeService
@implements IDisposable

<MudThemeProvider Theme="_theme" IsDarkMode="@ThemeService.IsDarkMode" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudText Typo="Typo.h5" Class="ml-3">Cypher Sheet</MudText>
        <MudSpacer />
    </MudAppBar>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Small" Class="mt-4 pb-16">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private MudTheme _theme = new MudTheme()
    {
        PaletteDark = new PaletteDark()
        {
            Primary = new MudBlazor.Utilities.MudColor("#8B5CF6"), // Roxo vibrante
            Secondary = new MudBlazor.Utilities.MudColor("#A78BFA"), // Lilás claro
            Surface = new MudBlazor.Utilities.MudColor("#1E1B2E"), // Roxo escuro para superfícies
            Background = new MudBlazor.Utilities.MudColor("#0F0D1A"), // Roxo muito escuro, quase preto
            AppbarBackground = new MudBlazor.Utilities.MudColor("#1E1B2E"), // Roxo escuro para app bar
            DrawerBackground = new MudBlazor.Utilities.MudColor("#1E1B2E"), // Roxo escuro para drawer
            ActionDefault = new MudBlazor.Utilities.MudColor("#6B46C1"), // Roxo médio para ações
            TextPrimary = new MudBlazor.Utilities.MudColor("#F8FAFC"), // Branco suave
            TextSecondary = new MudBlazor.Utilities.MudColor("#C1C7D0"), // Cinza claro
            TextDisabled = new MudBlazor.Utilities.MudColor("#64748B"), // Cinza médio
            Divider = new MudBlazor.Utilities.MudColor("#2D2438"), // Roxo escuro para divisores
            Error = new MudBlazor.Utilities.MudColor("#EF4444"), // Vermelho para erros
            Success = new MudBlazor.Utilities.MudColor("#10B981"), // Verde para sucesso
            Warning = new MudBlazor.Utilities.MudColor("#F59E0B"), // Amarelo para avisos
            Info = new MudBlazor.Utilities.MudColor("#8B5CF6") // Roxo para informações
        }
    };

    protected override async Task OnInitializedAsync()
    {
        await ThemeService.InitializeAsync();
        ThemeService.OnThemeChanged += StateHasChanged;
    }

    public void Dispose()
    {
        ThemeService.OnThemeChanged -= StateHasChanged;
    }
}
