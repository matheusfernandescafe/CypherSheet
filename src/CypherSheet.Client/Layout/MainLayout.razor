@using CypherSheet.Client.Services
@inherits LayoutComponentBase
@inject IThemeService ThemeService
@implements IDisposable

<MudThemeProvider Theme="_theme" IsDarkMode="@ThemeService.IsDarkMode" />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudLayout>
    <MudAppBar Elevation="1">
        <MudText Typo="Typo.h5" Class="ml-3">Cypher Sheet</MudText>
        <MudSpacer />
    </MudAppBar>
    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Small" Class="mt-4 pb-16">
            @Body
        </MudContainer>
    </MudMainContent>
</MudLayout>

@code {
    private MudTheme _theme = new MudTheme()
    {
        PaletteDark = new PaletteDark()
        {
            Primary = new MudBlazor.Utilities.MudColor("#4B95EC"),
            Surface = new MudBlazor.Utilities.MudColor("#343434"),
            Background = new MudBlazor.Utilities.MudColor("#191919"),
            AppbarBackground = new MudBlazor.Utilities.MudColor("#191919"), 
            DrawerBackground = new MudBlazor.Utilities.MudColor("#191919"), 
            ActionDefault = Colors.Gray.Lighten3,
            TextPrimary = Colors.Shades.White,
            TextSecondary = Colors.Gray.Lighten3,
            Error = new MudBlazor.Utilities.MudColor("#BD4949")
        }
    };

    protected override async Task OnInitializedAsync()
    {
        await ThemeService.InitializeAsync();
        ThemeService.OnThemeChanged += StateHasChanged;
    }

    public void Dispose()
    {
        ThemeService.OnThemeChanged -= StateHasChanged;
    }
}
